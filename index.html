<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HR Master Pro</title>

    <!-- Tailwind CDN: dùng tạm cho nhanh -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- XLSX để xuất Excel (dùng global XLSX) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
  </head>

  <body class="bg-slate-100">
    <div id="root"></div>

    <!-- React app: Vite sẽ bundle file module này, React lấy từ node_modules -->
    <script type="module">
      import React, { useState } from "react";
      import { createRoot } from "react-dom/client";

      const e = React.createElement;

      function App() {
        const [form, setForm] = useState({
          code: "",
          name: "",
          dept: "",
        });

        const [employees, setEmployees] = useState([]);

        function handleChange(evt) {
          const { name, value } = evt.target;
          setForm((f) => ({ ...f, [name]: value }));
        }

        function handleAdd(ev) {
          ev.preventDefault();
          if (!form.code.trim() || !form.name.trim()) {
            alert("Vui lòng nhập Mã NV và Họ tên");
            return;
          }
          setEmployees((list) => [...list, { ...form }]);
          setForm({ code: "", name: "", dept: "" });
        }

        function exportExcel() {
          if (employees.length === 0) {
            alert("Chưa có dữ liệu để xuất");
            return;
          }
          const wb = XLSX.utils.book_new();
          const ws = XLSX.utils.json_to_sheet(
            employees.map((r, i) => ({
              STT: i + 1,
              "Mã nhân viên": r.code,
              "Họ và tên": r.name,
              "Phòng ban": r.dept,
            }))
          );
          XLSX.utils.book_append_sheet(wb, ws, "NhanVien");
          XLSX.writeFile(wb, "nhan_vien.xlsx");
        }

        return e(
          "div",
          { className: "min-h-screen flex items-center justify-center p-6" },
          e(
            "div",
            {
              className:
                "bg-white shadow-xl rounded-2xl p-8 max-w-5xl w-full space-y-6",
            },
            // Header
            e(
              "div",
              { className: "flex items-center justify-between gap-4" },
              e(
                "div",
                null,
                e(
                  "h1",
                  { className: "text-2xl font-bold text-sky-700" },
                  "HR Master Pro"
                ),
                e(
                  "p",
                  { className: "text-slate-600" },
                  "Form demo: nhập nhân viên, lưu vào bảng và xuất Excel."
                )
              ),
              e(
                "span",
                {
                  className:
                    "inline-flex items-center px-3 py-1 text-xs font-medium rounded-full bg-sky-100 text-sky-700",
                },
                "Bản demo chạy React + Vite"
              )
            ),

            // Form nhập
            e(
              "form",
              {
                className:
                  "grid grid-cols-1 md:grid-cols-4 gap-4 items-end bg-slate-50 p-4 rounded-xl",
                onSubmit: handleAdd,
              },
              e(
                "div",
                { className: "space-y-1" },
                e(
                  "label",
                  { className: "text-sm font-medium text-slate-700" },
                  "Mã nhân viên"
                ),
                e("input", {
                  type: "text",
                  name: "code",
                  value: form.code,
                  onChange: handleChange,
                  className:
                    "w-full rounded-lg border-slate-300 text-sm px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-500",
                  placeholder: "VD: NV001",
                })
              ),
              e(
                "div",
                { className: "space-y-1 md:col-span-2" },
                e(
                  "label",
                  { className: "text-sm font-medium text-slate-700" },
                  "Họ và tên"
                ),
                e("input", {
                  type: "text",
                  name: "name",
                  value: form.name,
                  onChange: handleChange,
                  className:
                    "w-full rounded-lg border-slate-300 text-sm px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-500",
                  placeholder: "Nguyễn Văn A",
                })
              ),
              e(
                "div",
                { className: "space-y-1" },
                e(
                  "label",
                  { className: "text-sm font-medium text-slate-700" },
                  "Phòng ban"
                ),
                e("input", {
                  type: "text",
                  name: "dept",
                  value: form.dept,
                  onChange: handleChange,
                  className:
                    "w-full rounded-lg border-slate-300 text-sm px-3 py-2 focus:outline-none focus:ring-2 focus:ring-sky-500",
                  placeholder: "Kế toán / Nhân sự...",
                })
              ),
              e(
                "div",
                { className: "md:col-span-4 flex justify-end gap-2 pt-2" },
                e(
                  "button",
                  {
                    type: "button",
                    onClick: exportExcel,
                    className:
                      "px-4 py-2 rounded-lg text-sm bg-emerald-500 text-white hover:bg-emerald-600",
                  },
                  "Xuất Excel"
                ),
                e(
                  "button",
                  {
                    type: "submit",
                    className:
                      "px-4 py-2 rounded-lg text-sm bg-sky-600 text-white hover:bg-sky-700",
                  },
                  "Thêm nhân viên"
                )
              )
            ),

            // Bảng dữ liệu
            e(
              "div",
              {
                className:
                  "border border-slate-200 rounded-xl overflow-hidden bg-white",
              },
              e(
                "table",
                { className: "min-w-full text-sm" },
                e(
                  "thead",
                  { className: "bg-slate-50" },
                  e(
                    "tr",
                    null,
                    ["STT", "Mã nhân viên", "Họ và tên", "Phòng ban"].map(
                      (col) =>
                        e(
                          "th",
                          {
                            key: col,
                            className:
                              "px-4 py-2 text-left font-semibold text-slate-700",
                          },
                          col
                        )
                    )
                  )
                ),
                e(
                  "tbody",
                  null,
                  employees.length === 0
                    ? e(
                        "tr",
                        null,
                        e(
                          "td",
                          {
                            colSpan: 4,
                            className:
                              "px-4 py-6 text-center text-slate-400 text-sm",
                          },
                          "Chưa có dữ liệu. Hãy thêm nhân viên phía trên."
                        )
                      )
                    : employees.map((emp, idx) =>
                        e(
                          "tr",
                          {
                            key: emp.code + idx,
                            className:
                              idx % 2 === 0 ? "bg-white" : "bg-slate-50",
                          },
                          e(
                            "td",
                            { className: "px-4 py-2 text-slate-700" },
                            idx + 1
                          ),
                          e(
                            "td",
                            { className: "px-4 py-2 text-slate-700" },
                            emp.code
                          ),
                          e(
                            "td",
                            { className: "px-4 py-2 text-slate-700" },
                            emp.name
                          ),
                          e(
                            "td",
                            { className: "px-4 py-2 text-slate-700" },
                            emp.dept
                          )
                        )
                      )
                )
              )
            )
          )
        );
      }

      const root = createRoot(document.getElementById("root"));
      root.render(e(App));
    </script>
  </body>
</html>
